package org.seleniumistas;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.testng.Assert;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

public class MyFirstTests {

  private static final String SITE_URL = "http://the-internet.herokuapp.com/login";
  private static final String USERNAME_INPUT_ID = "username";
  private static final String PASSWORD_INPUT_ID = "password";
  private static final String LOGIN_BUTTON_CSS = "button[type='submit']";
  private static final String FLASH_MSG_TEXT_ID = "flash";

  private WebDriver driver;

  @BeforeTest
  public void setUp() {
    driver = new ChromeDriver();
    // To work with other browsers:
    // driver = new SafariDriver();
    // driver = new FirefoxDriver();
  }

  @Test(description = "Verify when login is successful, Logout button is displayed.")
  public void verifyLoginTest() {
    String username = "tomsmith";
    String password = "SuperSecretPassword!";

    // Go to the test site
    driver.get(SITE_URL);

    // Find username input field and enter username
    WebElement usernameInputElement = driver.findElement(By.id(USERNAME_INPUT_ID));
    usernameInputElement.sendKeys(username);

    // Find password input filed and enter password
    WebElement passwordInputElement = driver.findElement(By.id(PASSWORD_INPUT_ID));
    passwordInputElement.sendKeys(password);

    // Find Login button and click it
    WebElement loginButtonElement = driver.findElement(By.cssSelector(LOGIN_BUTTON_CSS));
    loginButtonElement.click();

    // Find flash test and get text
    String flashText = driver.findElement(By.id(FLASH_MSG_TEXT_ID)).getText();
    Assert.assertTrue(
        flashText.contains("You logged into a secure area!"),
        "Message is incorrect, should contain \"You logged into a secure area!\"");
  }

  @AfterMethod
  public void tearDown() {
    // terminate webdriver
    driver.quit();
  }
}
